<!DOCTYPE html>
<html lang="{{ lang }}" dir="{{ text_dir }}">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    {% if css_text %}
    <style>
        {{ css_text }}
    </style>
    {% endif %}
    
    <style>
        /* Font loading for PDF */
        @font-face {
            font-family: 'Vazirmatn';
            src: url('{{ pdf_font_regular_url }}') format('{{ pdf_font_regular_format or 'truetype' }}');
            font-weight: 400;
            font-style: normal;
            font-display: swap;
        }
        @font-face {
            font-family: 'Vazirmatn';
            src: url('{{ pdf_font_bold_url }}') format('{{ pdf_font_bold_format or 'truetype' }}');
            font-weight: 700;
            font-style: normal;
            font-display: swap;
        }
        
        /* Fallback fonts */
        body {
            font-family: 'Vazirmatn', 'Tahoma', 'Arial', sans-serif;
        }
    </style>
    <title>{{ meeting.title }}</title>
</head>
<body class="pdf-body">
    <!-- Header Section -->
    <header class="pdf-header">
        <div class="header-content">
            <div class="header-left">
                <h1 class="meeting-title">{{ meeting.title }}</h1>
                
                <div class="meeting-meta">
                    <div class="meta-item">
                        <div class="meta-icon"></div>
                        <span>{{ _('Date') }}: {{ date_jalali if lang == 'fa' else meeting.date.strftime('%Y-%m-%d') }}</span>
                    </div>
                    <div class="meta-item">
                        <div class="meta-icon"></div>
                        <span>{{ _('Company') }}: {{ company_display }}</span>
                    </div>
                    <div class="meta-item">
                        <div class="meta-icon"></div>
                        <span>{{ _('Created by') }}: {{ meeting.user.username if meeting.user else 'Unknown' }}</span>
                    </div>
                </div>
                
                <!-- Stats Grid -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-number">{{ (pnum(attendees_list|length) if pnum else attendees_list|length) }}</span>
                        <span class="stat-label">{{ _('Participants') }}</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">{{ (pnum(agenda_list|length) if pnum else agenda_list|length) }}</span>
                        <span class="stat-label">{{ _('Agenda Items') }}</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">{{ (pnum(action_items_list|length) if pnum else action_items_list|length) }}</span>
                        <span class="stat-label">{{ _('Action Items') }}</span>
                    </div>
                </div>
            </div>
            
            <div class="header-right">
                {% if logo_url %}
                <div class="logo-container">
                    <img src="{{ logo_url }}" alt="Logo" class="logo">
                </div>
                {% endif %}
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="pdf-content">
        <div class="content-grid">
            <!-- Participants Card -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">{{ _('Participants') }}</h2>
                    <span class="card-badge">{{ attendees_list|length }}</span>
                </div>
                <div class="participants-grid">
                    {% for attendee in attendees_list %}
                    <div class="participant-card">
                        <div class="participant-avatar">
                            {{ attendee[0] if attendee[0] else '?' }}
                        </div>
                        <p class="participant-name">{{ attendee }}</p>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <!-- Agenda Card -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">{{ _('Agenda') }}</h2>
                    <span class="card-badge">{{ agenda_list|length }}</span>
                </div>
                <ol class="agenda-list">
                    {% for item in agenda_list %}
                    <li class="agenda-item">
                        <div class="agenda-number">{{ loop.index }}</div>
                        <div class="agenda-text">{{ item }}</div>
                    </li>
                    {% endfor %}
                </ol>
            </div>
        </div>

        <!-- Meeting Minutes Card (Full Width) -->
        <div class="card full-width-card">
            <div class="card-header">
                <h2 class="card-title">{{ _('Meeting Minutes') }}</h2>
            </div>
            <div class="minutes-content">
                <p class="minutes-text">{{ meeting.minutes or _('No minutes recorded.') }}</p>
            </div>
        </div>

        <!-- Action Items Card (Full Width) -->
        {% if action_items_list %}
        <div class="card full-width-card">
            <div class="card-header">
                <h2 class="card-title">{{ _('Action Items') }}</h2>
                <span class="card-badge">{{ action_items_list|length }}</span>
            </div>
            <table class="action-table">
                <thead>
                    <tr>
                        <th>{{ _('Description') }}</th>
                        <th>{{ _('Responsible') }}</th>
                        <th>{{ _('Deadline') }}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in action_items_list %}
                    <tr>
                        <td>{{ item.description if item.description else _('No description') }}</td>
                        <td>{{ item.responsible if item.responsible else _('Not assigned') }}</td>
                        <td>
                            {% if item.deadline %}
                                {% if item.deadline is string %}
                                    {{ item.deadline }}
                                {% else %}
                                    {{ item.deadline.strftime('%Y-%m-%d') }}
                                {% endif %}
                            {% else %}
                                {{ _('No deadline') }}
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}
    </main>

    <!-- Footer -->
    <footer class="pdf-footer">
        <div class="footer-content">
            <div class="footer-left">
                <span>{{ _('Generated by Meeting Minutes App') }}</span>
                <span>•</span>
                <span>{{ meeting.user.username if meeting.user else 'Unknown' }}</span>
                <span>•</span>
                <span>{{ meeting.date.strftime('%Y-%m-%d') if meeting.date else 'Unknown' }}</span>
            </div>
            <div class="footer-right">
                <span>{{ _('Page') }} 1</span>
            </div>
        </div>
    </footer>
</body>
</html>